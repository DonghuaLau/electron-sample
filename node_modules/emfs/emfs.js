const Imap = require('imap')

function emfs (config) {

	if (!(this instanceof emfs))
		return new emfs(config);

	config || (config = {});
	this._config = config;

	this._index_dir = "EINDEX";
	this._data_dir = "EDATA";
	
	this._imap = null;

	console.dir(config);

	this.init();
}

emfs.prototype.init = function() {
	console.log("emfs init");

	this._imap = new Imap(this._config);
	
	//console.dir(this);
	this._imap._test_a = 10;
	this._imap.once('ready', function(){
		console.log("imap ready");
		console.log("imap ready, test_a: " + this._test_a);
		//console.dir(this);
	});

	this._imap.once('error', function(){
		console.log("imap error");
	});

	this._imap.once('end', function(){
		console.log("imap end");
	});
	
	this._imap.connect();

}

emfs.prototype.open_box = function() {
	console.log("emfs open_box");
}

module.exports = emfs;
